<aside id="comments" aria-hidden="true">
{% assign slug = page.url | slugify | downcase | replace: '.', '-' | replace: '_' : '-' %}
{% assign comments_map = site.data.comments[slug] %}
{% assign comments = "" | split: "," %}
{% for comment in comments_map %}
  {% assign comments = comments | push: comment[1] %}
{% endfor %}
{% assign comment_count = comments | size %}
{% if comment_count > 0 %}
  {% assign author = site.data.authors[page.author] %}
  <h2>{% if comment_count == 1 %}One Comment{% else %}{{ comment_count }} Comments{% endif %}</h2>
  <ol>
  {% assign sorted_comments = comments | sort: 'date' %}
  {% for comment in sorted_comments %}
    <li{% if comment.email == author.email %} class="by-author" {% endif %}>
      {% include comment.html %}
    </li>
  {% endfor %}
  </ol>
{% endif %}
{% if page.commenting == 'open' %}
  {% include comment-new.html %}
{% endif %}
</aside>

